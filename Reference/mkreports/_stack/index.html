

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.9">
    
    
      
        <title>_stack - Mkreports documentations</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2b4465f4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    

  

  

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mkreports._stack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Mkreports documentations" class="md-header__button md-logo" aria-label="Mkreports documentations" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mkreports documentations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              _stack
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Mkreports documentations" class="md-nav__button md-logo" aria-label="Mkreports documentations" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Mkreports documentations
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../basic/" class="md-nav__link">
        Basic
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../images/" class="md-nav__link">
        Images
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../tables/" class="md-nav__link">
        Tables
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../code_blocks/" class="md-nav__link">
        Code Blocks
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1" type="checkbox" id="__nav_8_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1">
          mkreports
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="mkreports" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_1">
          <span class="md-nav__icon md-icon"></span>
          mkreports
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          _stack
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        _stack
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack" class="md-nav__link">
    mkreports._stack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.FrameInfo" class="md-nav__link">
    FrameInfo
  </a>
  
    <nav class="md-nav" aria-label="FrameInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.FrameInfo.md_tree" class="md-nav__link">
    md_tree()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.StackDiff" class="md-nav__link">
    StackDiff
  </a>
  
    <nav class="md-nav" aria-label="StackDiff">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.StackDiff.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker" class="md-nav__link">
    Tracker
  </a>
  
    <nav class="md-nav" aria-label="Tracker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.finished" class="md-nav__link">
    finished
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.__enter__" class="md-nav__link">
    __enter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.__exit__" class="md-nav__link">
    __exit__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.start" class="md-nav__link">
    start()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.get_stack" class="md-nav__link">
    get_stack()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code_context/" class="md-nav__link">
        code_context
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docs/" class="md-nav__link">
        docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ipython/" class="md-nav__link">
        ipython
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_6" type="checkbox" id="__nav_8_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_6">
          md
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="md" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_6">
          <span class="md-nav__icon md-icon"></span>
          md
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/combo/" class="md-nav__link">
        combo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/containers/" class="md-nav__link">
        containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/docstring/" class="md-nav__link">
        docstring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/file/" class="md-nav__link">
        file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/header/" class="md-nav__link">
        header
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/idstore/" class="md-nav__link">
        idstore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/image/" class="md-nav__link">
        image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/list/" class="md-nav__link">
        list
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/settings/" class="md-nav__link">
        settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/table/" class="md-nav__link">
        table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md/text/" class="md-nav__link">
        text
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../md_proxy/" class="md-nav__link">
        md_proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parser/" class="md-nav__link">
        parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../report/" class="md-nav__link">
        report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tracker/" class="md-nav__link">
        tracker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack" class="md-nav__link">
    mkreports._stack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.FrameInfo" class="md-nav__link">
    FrameInfo
  </a>
  
    <nav class="md-nav" aria-label="FrameInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.FrameInfo.md_tree" class="md-nav__link">
    md_tree()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.StackDiff" class="md-nav__link">
    StackDiff
  </a>
  
    <nav class="md-nav" aria-label="StackDiff">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.StackDiff.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker" class="md-nav__link">
    Tracker
  </a>
  
    <nav class="md-nav" aria-label="Tracker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.finished" class="md-nav__link">
    finished
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.__enter__" class="md-nav__link">
    __enter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.__exit__" class="md-nav__link">
    __exit__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkreports._stack.Tracker.start" class="md-nav__link">
    start()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mkreports._stack.get_stack" class="md-nav__link">
    get_stack()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>_stack</h1>

<div class="doc doc-object doc-module">

<a id="mkreports._stack"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h2 id="mkreports._stack.FrameInfo" class="doc doc-heading">
        <code>
FrameInfo            (<span title="anytree.node.nodemixin.NodeMixin">NodeMixin</span>)
        </code>



</h2>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">FrameInfo</span><span class="p">(</span><span class="n">NodeMixin</span><span class="p">):</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">code_interval</span><span class="p">:</span> <span class="n">Interval</span>
    <span class="n">hilite_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Interval</span><span class="p">]</span>
    <span class="n">curlineno</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">code</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">co_name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">code_interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
        <span class="n">hilite_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Interval</span><span class="p">],</span>
        <span class="n">curlineno</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">code</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">co_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FrameInfo</span><span class="p">],</span>
        <span class="n">children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FrameInfo</span><span class="p">]],</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span> <span class="o">=</span> <span class="n">code_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="o">=</span> <span class="n">hilite_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curlineno</span> <span class="o">=</span> <span class="n">curlineno</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">co_name</span> <span class="o">=</span> <span class="n">co_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">if</span> <span class="n">children</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="n">children</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">position</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hilite_interval</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">header</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus_code</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">begin</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">focus_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hilite_interval</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">focus_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">display_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">begin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">begin</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">begin</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">display_code</span>

    <span class="k">def</span> <span class="nf">md_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">highlight</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">full_filename</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Code</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">highlight</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
            <span class="n">first_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">begin</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_interval</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus_interval</span><span class="p">:</span>
                <span class="n">hl_lines</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hl_lines</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># no highlight, so we take the focused range</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus_code</span>
            <span class="n">first_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">begin</span>
            <span class="n">hl_lines</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">Code</span><span class="p">(</span>
            <span class="n">code</span><span class="o">=</span><span class="n">dedent</span><span class="p">(</span><span class="n">code</span><span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="k">if</span> <span class="n">full_filename</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">first_line</span><span class="o">=</span><span class="n">first_line</span><span class="p">,</span>
            <span class="n">hl_lines</span><span class="o">=</span><span class="n">hl_lines</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_md_collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">highlight</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Code</span><span class="p">]]:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">co_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">md_code</span><span class="p">(</span><span class="n">highlight</span><span class="o">=</span><span class="n">highlight</span><span class="p">))]</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">_md_collect</span><span class="p">(</span><span class="n">highlight</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">md_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">highlight</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">full_filename</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MdObj</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the code in a tree.</span>

<span class="sd">        If there is only a single node, a simple Code object is returned,</span>
<span class="sd">        otherwise Tabs are produced for the code. In the tabs,</span>
<span class="sd">        functions that occur earlier in the code are listed first.</span>
<span class="sd">        Also, functions are only listed once even if they occur deeper in the</span>
<span class="sd">        tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">code_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_collect</span><span class="p">(</span><span class="n">highlight</span><span class="p">)</span>

        <span class="c1"># now only take the unique ones</span>
        <span class="n">code_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">code_list</span><span class="p">}</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1"># now we want to de-duplicate the list</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">code_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">Tab</span><span class="p">(</span><span class="n">code_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&lt;main&gt;&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_list</span><span class="p">)):</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="n">Tab</span><span class="p">(</span>
                        <span class="n">code_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">title</span><span class="o">=</span><span class="n">code_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">full_filename</span>
                        <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="n">code_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Raw</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_frame</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;FrameInfo&quot;</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span>

        <span class="c1"># if higher_frame is None and code.co_firstlineno != 1:</span>
        <span class="c1">#    raise Exception(</span>
        <span class="c1">#        f&quot;Did not expect first line {code.co_firstlineno} when upper frame is None.&quot;</span>
        <span class="c1">#    )</span>
        <span class="c1"># if higher_frame is None:</span>
        <span class="c1">#    code_lines = read_file(Path(code.co_filename))</span>
        <span class="c1"># else:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">code</span><span class="o">.</span><span class="n">co_name</span> <span class="o">==</span> <span class="s2">&quot;&lt;module&gt;&quot;</span><span class="p">:</span>
                <span class="n">code_lines</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">code_lines</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">code</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">code_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Count not get source</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">FrameInfo</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">,</span>
            <span class="n">co_name</span><span class="o">=</span><span class="n">code</span><span class="o">.</span><span class="n">co_name</span><span class="p">,</span>
            <span class="n">code_interval</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span>
                <span class="n">code</span><span class="o">.</span><span class="n">co_firstlineno</span><span class="p">,</span>
                <span class="n">code</span><span class="o">.</span><span class="n">co_firstlineno</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_lines</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">hilite_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">curlineno</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">,</span>
            <span class="n">code</span><span class="o">=</span><span class="n">code_lines</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="n">children</span><span class="o">=</span><span class="n">children</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  <div class="doc doc-object doc-method">



<h3 id="mkreports._stack.FrameInfo.md_tree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">md_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">full_filename</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Return the code in a tree.</p>
<p>If there is only a single node, a simple Code object is returned,
otherwise Tabs are produced for the code. In the tabs,
functions that occur earlier in the code are listed first.
Also, functions are only listed once even if they occur deeper in the
tree.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">md_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">highlight</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">full_filename</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MdObj</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the code in a tree.</span>

<span class="sd">    If there is only a single node, a simple Code object is returned,</span>
<span class="sd">    otherwise Tabs are produced for the code. In the tabs,</span>
<span class="sd">    functions that occur earlier in the code are listed first.</span>
<span class="sd">    Also, functions are only listed once even if they occur deeper in the</span>
<span class="sd">    tree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">code_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_collect</span><span class="p">(</span><span class="n">highlight</span><span class="p">)</span>

    <span class="c1"># now only take the unique ones</span>
    <span class="n">code_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">code_list</span><span class="p">}</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="c1"># now we want to de-duplicate the list</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">code_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">Tab</span><span class="p">(</span><span class="n">code_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&lt;main&gt;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">code_list</span><span class="p">)):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="n">Tab</span><span class="p">(</span>
                    <span class="n">code_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">code_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">full_filename</span>
                    <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="n">code_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Raw</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="mkreports._stack.StackDiff" class="doc doc-heading">
        <code>
StackDiff        </code>



</h2>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">StackDiff</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">,</span> <span class="n">second_stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the difference of two stacks.</span>

<span class="sd">        Shows the code executed between the old stack and the new.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first_stack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">second_stack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">equal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">))):</span>
            <span class="n">frame_old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">frame_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">frame_old</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="n">frame_new</span><span class="o">.</span><span class="n">filename</span>
                <span class="ow">and</span> <span class="n">frame_old</span><span class="o">.</span><span class="n">code_interval</span> <span class="o">==</span> <span class="n">frame_new</span><span class="o">.</span><span class="n">code_interval</span>
            <span class="p">):</span>
                <span class="c1"># this is within the same function</span>
                <span class="k">if</span> <span class="n">frame_old</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="o">==</span> <span class="n">frame_new</span><span class="o">.</span><span class="n">hilite_interval</span><span class="p">:</span>
                    <span class="c1"># this is the same, no change</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">equal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame_old</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># execution has at least moved by one code line</span>
                    <span class="c1"># store the lower levels of the old frame</span>
                    <span class="c1"># then the difference in the current frame to the new</span>
                    <span class="c1"># then the lower levels of the new frame</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">old_lower</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">FrameInfo</span><span class="p">(</span>
                            <span class="n">filename</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                            <span class="n">code_interval</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">code_interval</span><span class="p">,</span>
                            <span class="n">hilite_interval</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">.</span><span class="n">curlineno</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">end</span>
                            <span class="p">),</span>
                            <span class="n">curlineno</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                            <span class="n">code</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                            <span class="n">co_name</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">co_name</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">children</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                    <span class="p">]</span>
                    <span class="n">middle_frame</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                    <span class="n">middle_frame</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">middle</span> <span class="o">=</span> <span class="p">[</span><span class="n">middle_frame</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">new_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">frame</span> <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_lower</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">middle</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_lower</span>
                    <span class="k">return</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="mkreports._stack.StackDiff.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_stack</span><span class="p">,</span> <span class="n">second_stack</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Calculate the difference of two stacks.</p>
<p>Shows the code executed between the old stack and the new.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">,</span> <span class="n">second_stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the difference of two stacks.</span>

<span class="sd">    Shows the code executed between the old stack and the new.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first_stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="n">second_stack</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">equal</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">))):</span>
        <span class="n">frame_old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">frame_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">frame_old</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="n">frame_new</span><span class="o">.</span><span class="n">filename</span>
            <span class="ow">and</span> <span class="n">frame_old</span><span class="o">.</span><span class="n">code_interval</span> <span class="o">==</span> <span class="n">frame_new</span><span class="o">.</span><span class="n">code_interval</span>
        <span class="p">):</span>
            <span class="c1"># this is within the same function</span>
            <span class="k">if</span> <span class="n">frame_old</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="o">==</span> <span class="n">frame_new</span><span class="o">.</span><span class="n">hilite_interval</span><span class="p">:</span>
                <span class="c1"># this is the same, no change</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">equal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame_old</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># execution has at least moved by one code line</span>
                <span class="c1"># store the lower levels of the old frame</span>
                <span class="c1"># then the difference in the current frame to the new</span>
                <span class="c1"># then the lower levels of the new frame</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">old_lower</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">FrameInfo</span><span class="p">(</span>
                        <span class="n">filename</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                        <span class="n">code_interval</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">code_interval</span><span class="p">,</span>
                        <span class="n">hilite_interval</span><span class="o">=</span><span class="n">Interval</span><span class="p">(</span>
                            <span class="n">frame</span><span class="o">.</span><span class="n">curlineno</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">end</span>
                        <span class="p">),</span>
                        <span class="n">curlineno</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">code_interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                        <span class="n">code</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                        <span class="n">co_name</span><span class="o">=</span><span class="n">frame</span><span class="o">.</span><span class="n">co_name</span><span class="p">,</span>
                        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">children</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="p">]</span>
                <span class="n">middle_frame</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="n">middle_frame</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">focus_interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">middle</span> <span class="o">=</span> <span class="p">[</span><span class="n">middle_frame</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">frame</span> <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_lower</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">middle</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_lower</span>
                <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="mkreports._stack.Tracker" class="doc doc-heading">
        <code>
Tracker        </code>



</h2>

    <div class="doc doc-contents ">

      <p>Used to profile the code in order to detect executed functions.</p>
<p>It is intended to be used as a context manager. When entering
the context, the profiler will be set and all subsequent
function calls will be recorded. Afterwards the profiling
is stopped.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Tracker</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to profile the code in order to detect executed functions.</span>

<span class="sd">    It is intended to be used as a context manager. When entering</span>
<span class="sd">    the context, the profiler will be set and all subsequent</span>
<span class="sd">    function calls will be recorded. Afterwards the profiling</span>
<span class="sd">    is stopped.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dirs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AnyPath</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">packages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ModuleType</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">omit_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dirs</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dirs</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">my_dirs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dirs</span><span class="p">)</span>  <span class="c1"># don&#39;t need to do anything</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dirs</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">)):</span>
            <span class="n">my_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">dirs</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">my_dirs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
            <span class="n">packages</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">ModuleType</span><span class="p">):</span>
            <span class="n">packages</span> <span class="o">=</span> <span class="p">[</span><span class="n">packages</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">packages</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># for the packages, we also convert them to directories</span>
        <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
            <span class="c1"># always use the first element of the list</span>
            <span class="n">my_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">package</span><span class="o">.</span><span class="n">__path__</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="c1"># make the directories strings with a slash at the end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_dirs</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">omit_levels</span> <span class="o">=</span> <span class="n">omit_levels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_levels</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activate the tracking.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrackerActiveError</span><span class="p">(</span><span class="s2">&quot;Context manager is already active&quot;</span><span class="p">)</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_callee_frame</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="n">omit_levels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># save the tree for storing the information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">FrameInfo</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

        <span class="c1"># include the current file in the directories to accept</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span><span class="p">))</span>

        <span class="c1"># here we actually want the next command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
        <span class="n">stmt_tree</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_stmt_ranges</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">))</span>
        <span class="n">stmt_after</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">closest_after</span><span class="p">(</span><span class="n">stmt_tree</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stmt_after</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entry_lineno</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entry_lineno</span> <span class="o">=</span> <span class="n">stmt_after</span><span class="o">.</span><span class="n">begin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># we get the directory of the callee</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
            <span class="c1"># sys.settrace(None)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logger already set to </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_levels</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrackerNotActiveError</span><span class="p">(</span><span class="s2">&quot;Context manager is not active&quot;</span><span class="p">)</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_callee_frame</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="n">omit_levels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># we set the display range</span>
        <span class="c1"># the display_range should go to the end of the current statement</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># here we want to have the true ending line number</span>
            <span class="n">stmt_tree</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_stmt_ranges</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">))</span>
            <span class="n">cur_stmt_lines</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">smallest_overlap</span><span class="p">(</span><span class="n">stmt_tree</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_stmt_lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">hilite_interval</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">entry_lineno</span><span class="p">,</span> <span class="n">cur_stmt_lines</span><span class="o">.</span><span class="n">end</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find current statement&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;__enter__ has not been called.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Tracker&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Enter context manager and set the profiler.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove the profiler when exiting the context manager.&quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">traceback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">finished</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Tracker ctx manager has been finished.&quot;&quot;&quot;</span>
        <span class="c1"># The tracker context manager has been finished if</span>
        <span class="c1"># the node is not None, but also the ctx-manager is not active.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span>

    <span class="k">def</span> <span class="nf">_get_callee_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_levels</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FrameType</span><span class="p">:</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span>
        <span class="c1"># need to jump over the specified number of levels</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">omit_levels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;frame is None&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_back</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;frame is None&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frame</span>

    <span class="k">def</span> <span class="nf">frame_traceable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">FrameType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">frame_path</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span>
        <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">frame_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">notrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">trace_reset_on_return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">frame</span><span class="p">,</span> <span class="n">arg</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;return&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span>

    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">arg</span>
        <span class="c1"># when tracing, only care if it is a &#39;call&#39; event</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;call&quot;</span><span class="p">:</span>
            <span class="c1"># if it is inside the approved dirs, keep tracing;</span>
            <span class="c1"># otherwise we turn it off</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_traceable</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
                <span class="c1"># add the code object to the things that are traced</span>
                <span class="c1"># we put this as part of the tree</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span> <span class="o">=</span> <span class="n">FrameInfo</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># we stop tracing</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notrace</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace_reset_on_return</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;return&quot;</span><span class="p">:</span>
            <span class="c1"># set the current node to the parent in the tree</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span><span class="o">.</span><span class="n">parent</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;cur_node should not be None&quot;</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="mkreports._stack.Tracker.finished" class="doc doc-heading">
<code class="highlight language-python"><span class="n">finished</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Tracker ctx manager has been finished.</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 id="mkreports._stack.Tracker.__enter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Enter context manager and set the profiler.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Tracker&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Enter context manager and set the profiler.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mkreports._stack.Tracker.__exit__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Remove the profiler when exiting the context manager.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Remove the profiler when exiting the context manager.&quot;&quot;&quot;</span>
    <span class="k">del</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">traceback</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 id="mkreports._stack.Tracker.start" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_levels</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Activate the tracking.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_levels</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Activate the tracking.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TrackerActiveError</span><span class="p">(</span><span class="s2">&quot;Context manager is already active&quot;</span><span class="p">)</span>

    <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_callee_frame</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="n">omit_levels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># save the tree for storing the information</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">FrameInfo</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

    <span class="c1"># include the current file in the directories to accept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_dirs</span><span class="p">))</span>

    <span class="c1"># here we actually want the next command</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cur_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
    <span class="n">stmt_tree</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_stmt_ranges</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">))</span>
    <span class="n">stmt_after</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">closest_after</span><span class="p">(</span><span class="n">stmt_tree</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stmt_after</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_lineno</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_lineno</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_lineno</span> <span class="o">=</span> <span class="n">stmt_after</span><span class="o">.</span><span class="n">begin</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ctx_active</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># we get the directory of the callee</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
        <span class="c1"># sys.settrace(None)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logger already set to </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>








  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="mkreports._stack.get_stack" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_stack</span><span class="p">(</span><span class="n">omit_levels</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Get a simplified version of the stack.</p>

        <details class="quote">
          <summary>Source code in <code>mkreports/_stack.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_stack</span><span class="p">(</span><span class="n">omit_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Stack</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a simplified version of the stack.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span>
    <span class="c1"># need to jump over the specified number of levels</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">omit_levels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;frame is None&quot;</span><span class="p">)</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_back</span>

    <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FrameInfo</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_back</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">stack</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../../code_blocks/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Code Blocks" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Code Blocks
            </div>
          </div>
        </a>
      
      
        
        <a href="../code_context/" class="md-footer__link md-footer__link--next" aria-label="Next: code_context" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              code_context
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>